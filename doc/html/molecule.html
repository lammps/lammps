

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>molecule command &mdash; LAMMPS documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/lammps.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/lammps.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->

  
  <script src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="neb command" href="neb.html" />
    <link rel="prev" title="minimize command" href="minimize.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="Manual.html">
          

          
            
            <img src="_static/lammps-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="lammps_version">Version: <b>24 Dec 2020</b></div>
              <div class="lammps_release">git info: patch 24Dec2020-115-g2b8a0d310</div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">2. Install LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Build.html">3. Build LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Run_head.html">4. Run LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Commands.html">5. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Packages.html">6. Optional packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Speed.html">7. Accelerate performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="Howto.html">8. Howto discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">9. Example scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tools.html">10. Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Errors.html">11. Errors</a></li>
</ul>
<p class="caption"><span class="caption-text">Programmer Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Library.html">1. LAMMPS Library Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="Python_head.html">2. Use Python with LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modify.html">3. Modifying &amp; extending LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Developer.html">4. Information for Developers</a></li>
</ul>
<p class="caption"><span class="caption-text">Index</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="commands_list.html">Commands</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="angle_coeff.html">angle_coeff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="angle_style.html">angle_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="atom_modify.html">atom_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="atom_style.html">atom_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="balance.html">balance command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_coeff.html">bond_coeff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_style.html">bond_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="bond_write.html">bond_write command</a></li>
<li class="toctree-l2"><a class="reference internal" href="boundary.html">boundary command</a></li>
<li class="toctree-l2"><a class="reference internal" href="box.html">box command</a></li>
<li class="toctree-l2"><a class="reference internal" href="change_box.html">change_box command</a></li>
<li class="toctree-l2"><a class="reference internal" href="clear.html">clear command</a></li>
<li class="toctree-l2"><a class="reference internal" href="comm_modify.html">comm_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="comm_style.html">comm_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute.html">compute command</a></li>
<li class="toctree-l2"><a class="reference internal" href="compute_modify.html">compute_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="create_atoms.html">create_atoms command</a></li>
<li class="toctree-l2"><a class="reference internal" href="create_bonds.html">create_bonds command</a></li>
<li class="toctree-l2"><a class="reference internal" href="create_box.html">create_box command</a></li>
<li class="toctree-l2"><a class="reference internal" href="delete_atoms.html">delete_atoms command</a></li>
<li class="toctree-l2"><a class="reference internal" href="delete_bonds.html">delete_bonds command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dielectric.html">dielectric command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_coeff.html">dihedral_coeff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dihedral_style.html">dihedral_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dimension.html">dimension command</a></li>
<li class="toctree-l2"><a class="reference internal" href="displace_atoms.html">displace_atoms command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html">dump command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html#dump-vtk-command"><span class="xref std std-doc">dump vtk</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html#dump-h5md-command"><span class="xref std std-doc">dump h5md</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html#dump-molfile-command"><span class="xref std std-doc">dump molfile</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html#dump-netcdf-command"><span class="xref std std-doc">dump netcdf</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html#dump-image-command"><span class="xref std std-doc">dump image</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html#dump-movie-command"><span class="xref std std-doc">dump movie</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html#dump-atom-adios-command"><span class="xref std std-doc">dump atom/adios</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html#dump-custom-adios-command"><span class="xref std std-doc">dump custom/adios</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_adios.html">dump atom/adios  command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_adios.html#dump-custom-adios-command">dump custom/adios command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_cfg_uef.html">dump cfg/uef command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_h5md.html">dump h5md command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_image.html">dump image command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_image.html#dump-movie-command">dump movie command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_modify.html">dump_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_molfile.html">dump molfile command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_netcdf.html">dump netcdf command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_netcdf.html#dump-netcdf-mpiio-command">dump netcdf/mpiio command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump_vtk.html">dump vtk command</a></li>
<li class="toctree-l2"><a class="reference internal" href="dynamical_matrix.html">dynamical_matrix command</a></li>
<li class="toctree-l2"><a class="reference internal" href="echo.html">echo command</a></li>
<li class="toctree-l2"><a class="reference internal" href="fix.html">fix command</a></li>
<li class="toctree-l2"><a class="reference internal" href="fix_modify.html">fix_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="group.html">group command</a></li>
<li class="toctree-l2"><a class="reference internal" href="group2ndx.html">group2ndx command</a></li>
<li class="toctree-l2"><a class="reference internal" href="group2ndx.html#ndx2group-command">ndx2group command</a></li>
<li class="toctree-l2"><a class="reference internal" href="hyper.html">hyper command</a></li>
<li class="toctree-l2"><a class="reference internal" href="if.html">if command</a></li>
<li class="toctree-l2"><a class="reference internal" href="improper_coeff.html">improper_coeff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="improper_style.html">improper_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="include.html">include command</a></li>
<li class="toctree-l2"><a class="reference internal" href="info.html">info command</a></li>
<li class="toctree-l2"><a class="reference internal" href="jump.html">jump command</a></li>
<li class="toctree-l2"><a class="reference internal" href="kim_commands.html"><span class="xref std std-ref">kim_init</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="kim_commands.html#kim-interactions-command"><span class="xref std std-ref">kim_interactions</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="kim_commands.html#kim-query-command"><span class="xref std std-ref">kim_query</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="kim_commands.html#kim-param-command"><span class="xref std std-ref">kim_param</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="kim_commands.html#kim-property-command"><span class="xref std std-ref">kim_property</span> command</a></li>
<li class="toctree-l2"><a class="reference internal" href="kspace_modify.html">kspace_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="kspace_style.html">kspace_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="label.html">label command</a></li>
<li class="toctree-l2"><a class="reference internal" href="lattice.html">lattice command</a></li>
<li class="toctree-l2"><a class="reference internal" href="log.html">log command</a></li>
<li class="toctree-l2"><a class="reference internal" href="mass.html">mass command</a></li>
<li class="toctree-l2"><a class="reference internal" href="message.html">message command</a></li>
<li class="toctree-l2"><a class="reference internal" href="min_modify.html">min_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="min_spin.html">min_style spin command</a></li>
<li class="toctree-l2"><a class="reference internal" href="min_spin.html#min-style-spin-cg-command">min_style spin/cg command</a></li>
<li class="toctree-l2"><a class="reference internal" href="min_spin.html#min-style-spin-lbfgs-command">min_style spin/lbfgs command</a></li>
<li class="toctree-l2"><a class="reference internal" href="min_style.html">min_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="minimize.html">minimize command</a></li>
<li class="toctree-l2"><a class="reference internal" href="minimize.html#minimize-kk-command">minimize/kk command</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">molecule command</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#syntax">Syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#description">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="#restrictions">Restrictions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#related-commands">Related commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#default">Default</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="neb.html">neb command</a></li>
<li class="toctree-l2"><a class="reference internal" href="neb_spin.html">neb/spin command</a></li>
<li class="toctree-l2"><a class="reference internal" href="neigh_modify.html">neigh_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="neighbor.html">neighbor command</a></li>
<li class="toctree-l2"><a class="reference internal" href="newton.html">newton command</a></li>
<li class="toctree-l2"><a class="reference internal" href="next.html">next command</a></li>
<li class="toctree-l2"><a class="reference internal" href="package.html">package command</a></li>
<li class="toctree-l2"><a class="reference internal" href="pair_coeff.html">pair_coeff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="pair_modify.html">pair_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="pair_style.html">pair_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="pair_write.html">pair_write command</a></li>
<li class="toctree-l2"><a class="reference internal" href="partition.html">partition command</a></li>
<li class="toctree-l2"><a class="reference internal" href="prd.html">prd command</a></li>
<li class="toctree-l2"><a class="reference internal" href="print.html">print command</a></li>
<li class="toctree-l2"><a class="reference internal" href="processors.html">processors command</a></li>
<li class="toctree-l2"><a class="reference internal" href="python.html">python command</a></li>
<li class="toctree-l2"><a class="reference internal" href="quit.html">quit command</a></li>
<li class="toctree-l2"><a class="reference internal" href="read_data.html">read_data command</a></li>
<li class="toctree-l2"><a class="reference internal" href="read_dump.html">read_dump command</a></li>
<li class="toctree-l2"><a class="reference internal" href="read_restart.html">read_restart command</a></li>
<li class="toctree-l2"><a class="reference internal" href="region.html">region command</a></li>
<li class="toctree-l2"><a class="reference internal" href="replicate.html">replicate command</a></li>
<li class="toctree-l2"><a class="reference internal" href="rerun.html">rerun command</a></li>
<li class="toctree-l2"><a class="reference internal" href="reset_atom_ids.html">reset_atom_ids command</a></li>
<li class="toctree-l2"><a class="reference internal" href="reset_mol_ids.html">reset_mol_ids command</a></li>
<li class="toctree-l2"><a class="reference internal" href="reset_timestep.html">reset_timestep command</a></li>
<li class="toctree-l2"><a class="reference internal" href="restart.html">restart command</a></li>
<li class="toctree-l2"><a class="reference internal" href="run.html">run command</a></li>
<li class="toctree-l2"><a class="reference internal" href="run_style.html">run_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="server.html">server command</a></li>
<li class="toctree-l2"><a class="reference internal" href="server_mc.html">server mc command</a></li>
<li class="toctree-l2"><a class="reference internal" href="server_md.html">server md command</a></li>
<li class="toctree-l2"><a class="reference internal" href="set.html">set command</a></li>
<li class="toctree-l2"><a class="reference internal" href="shell.html">shell command</a></li>
<li class="toctree-l2"><a class="reference internal" href="special_bonds.html">special_bonds command</a></li>
<li class="toctree-l2"><a class="reference internal" href="suffix.html">suffix command</a></li>
<li class="toctree-l2"><a class="reference internal" href="tad.html">tad command</a></li>
<li class="toctree-l2"><a class="reference internal" href="temper.html">temper command</a></li>
<li class="toctree-l2"><a class="reference internal" href="temper_grem.html">temper/grem command</a></li>
<li class="toctree-l2"><a class="reference internal" href="temper_npt.html">temper/npt command</a></li>
<li class="toctree-l2"><a class="reference internal" href="thermo.html">thermo command</a></li>
<li class="toctree-l2"><a class="reference internal" href="thermo_modify.html">thermo_modify command</a></li>
<li class="toctree-l2"><a class="reference internal" href="thermo_style.html">thermo_style command</a></li>
<li class="toctree-l2"><a class="reference internal" href="third_order.html">third_order command</a></li>
<li class="toctree-l2"><a class="reference internal" href="timer.html">timer command</a></li>
<li class="toctree-l2"><a class="reference internal" href="timestep.html">timestep command</a></li>
<li class="toctree-l2"><a class="reference internal" href="uncompute.html">uncompute command</a></li>
<li class="toctree-l2"><a class="reference internal" href="undump.html">undump command</a></li>
<li class="toctree-l2"><a class="reference internal" href="unfix.html">unfix command</a></li>
<li class="toctree-l2"><a class="reference internal" href="units.html">units command</a></li>
<li class="toctree-l2"><a class="reference internal" href="variable.html">variable command</a></li>
<li class="toctree-l2"><a class="reference internal" href="velocity.html">velocity command</a></li>
<li class="toctree-l2"><a class="reference internal" href="write_coeff.html">write_coeff command</a></li>
<li class="toctree-l2"><a class="reference internal" href="write_data.html">write_data command</a></li>
<li class="toctree-l2"><a class="reference internal" href="write_dump.html">write_dump command</a></li>
<li class="toctree-l2"><a class="reference internal" href="write_restart.html">write_restart command</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fixes.html">Fixes</a></li>
<li class="toctree-l1"><a class="reference internal" href="computes.html">Computes</a></li>
<li class="toctree-l1"><a class="reference internal" href="pairs.html">Pair Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="bonds.html">Bond Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="angles.html">Angle Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="dihedrals.html">Dihedral Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="impropers.html">Improper Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="fix_modify_atc_commands.html">fix_modify AtC commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bibliography.html">Bibliography</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="Manual.html">LAMMPS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="Manual.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="commands_list.html">Commands</a> &raquo;</li>
        
      <li>molecule command</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
          <a href="http://lammps.sandia.gov">Website</a>
          <a href="Commands_all.html">Commands</a>
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="neb.html" class="btn btn-neutral float-right" title="neb command" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="minimize.html" class="btn btn-neutral float-left" title="minimize command" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="molecule-command">
<span id="index-0"></span><h1>molecule command<a class="headerlink" href="#molecule-command" title="Permalink to this headline">¶</a></h1>
<div class="section" id="syntax">
<h2>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>molecule ID file1 keyword values ... file2 keyword values ... fileN ...
</pre></div>
</div>
<ul>
<li><p>ID = user-assigned name for the molecule template</p></li>
<li><p>file1,file2,… = names of files containing molecule descriptions</p></li>
<li><p>zero or more keyword/value pairs may be appended after each file</p></li>
<li><p>keyword = <em>offset</em> or <em>toff</em> or <em>boff</em> or <em>aoff</em> or <em>doff</em> or <em>ioff</em> or <em>scale</em></p>
<pre class="literal-block"><em>offset</em> values = Toff Boff Aoff Doff Ioff
  Toff = offset to add to atom types
  Boff = offset to add to bond types
  Aoff = offset to add to angle types
  Doff = offset to add to dihedral types
  Ioff = offset to add to improper types
<em>toff</em> value = Toff
  Toff = offset to add to atom types
<em>boff</em> value = Boff
  Boff = offset to add to bond types
<em>aoff</em> value = Aoff
  Aoff = offset to add to angle types
<em>doff</em> value = Doff
  Doff = offset to add to dihedral types
<em>ioff</em> value = Ioff
  Ioff = offset to add to improper types
<em>scale</em> value = sfactor
  sfactor = scale factor to apply to the size and mass of the molecule</pre>
</li>
</ul>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="highlight-LAMMPS notranslate"><div class="highlight"><pre><span></span><span class="k">molecule</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">mymol.txt</span><span class="w"></span>
<span class="k">molecule</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">co2.txt</span><span class="w"> </span><span class="n">h2o.txt</span><span class="w"></span>
<span class="k">molecule</span><span class="w"> </span><span class="n">CO2</span><span class="w"> </span><span class="n">co2.txt</span><span class="w"> </span><span class="n">boff</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">aoff</span><span class="w"> </span><span class="m">2</span><span class="w"></span>
<span class="k">molecule</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">mymol.txt</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">18</span><span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">14</span><span class="w"></span>
<span class="k">molecule</span><span class="w"> </span><span class="n">objects</span><span class="w"> </span><span class="n">file.1</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="m">1.5</span><span class="w"> </span><span class="n">file.1</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="m">2.0</span><span class="w"> </span><span class="n">file.2</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="m">1.3</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>Define a molecule template that can be used as part of other LAMMPS
commands, typically to define a collection of particles as a bonded
molecule or a rigid body.  Commands that currently use molecule
templates include:</p>
<ul class="simple">
<li><p><a class="reference internal" href="fix_deposit.html"><span class="doc">fix deposit</span></a></p></li>
<li><p><a class="reference internal" href="fix_pour.html"><span class="doc">fix pour</span></a></p></li>
<li><p><a class="reference internal" href="fix_rigid.html"><span class="doc">fix rigid/small</span></a></p></li>
<li><p><a class="reference internal" href="fix_shake.html"><span class="doc">fix shake</span></a></p></li>
<li><p><a class="reference internal" href="fix_gcmc.html"><span class="doc">fix gcmc</span></a></p></li>
<li><p><a class="reference internal" href="fix_bond_react.html"><span class="doc">fix bond/react</span></a></p></li>
<li><p><a class="reference internal" href="create_atoms.html"><span class="doc">create_atoms</span></a></p></li>
<li><p><a class="reference internal" href="atom_style.html"><span class="doc">atom_style template</span></a></p></li>
</ul>
<p>The ID of a molecule template can only contain alphanumeric characters
and underscores.</p>
<p>A single template can contain multiple molecules, listed one per file.
Some of the commands listed above currently use only the first
molecule in the template, and will issue a warning if the template
contains multiple molecules.  The <a class="reference internal" href="atom_style.html"><span class="doc">atom_style template</span></a> command allows multiple-molecule templates
to define a system with more than one templated molecule.</p>
<p>Each filename can be followed by optional keywords which are applied
only to the molecule in the file as used in this template.  This is to
make it easy to use the same molecule file in different molecule
templates or in different simulations.  You can specify the same file
multiple times with different optional keywords.</p>
<p>The <em>offset</em>, <em>toff</em>, <em>boff</em>, <em>aoff</em>, <em>doff</em>, <em>ioff</em> keywords
add the specified offset values to the atom types, bond types, angle
types, dihedral types, and/or improper types as they are read from the
molecule file.  E.g. if <em>toff</em> = 2, and the file uses atom types
1,2,3, then each created molecule will have atom types 3,4,5.  For the
<em>offset</em> keyword, all five offset values must be specified, but
individual values will be ignored if the molecule template does not
use that attribute (e.g. no bonds).</p>
<p>The <em>scale</em> keyword scales the size of the molecule.  This can be
useful for modeling polydisperse granular rigid bodies.  The scale
factor is applied to each of these properties in the molecule file, if
they are defined: the individual particle coordinates (Coords
section), the individual mass of each particle (Masses section), the
individual diameters of each particle (Diameters section), the total
mass of the molecule (header keyword = mass), the center-of-mass of
the molecule (header keyword = com), and the moments of inertia of the
molecule (header keyword = inertia).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The molecule command can be used to define molecules with bonds,
angles, dihedrals, impropers, or special bond lists of neighbors
within a molecular topology, so that you can later add the molecules
to your simulation, via one or more of the commands listed above.
Since this topology-related information requires that suitable storage
is reserved when LAMMPS creates the simulation box (e.g. when using
the <a class="reference internal" href="create_box.html"><span class="doc">create_box</span></a> command or the
<a class="reference internal" href="read_data.html"><span class="doc">read_data</span></a> command) suitable space has to be reserved
so you do not overflow those pre-allocated data structures when adding
molecules later.  Both the <a class="reference internal" href="create_box.html"><span class="doc">create_box</span></a> command and
the <a class="reference internal" href="read_data.html"><span class="doc">read_data</span></a> command have “extra” options which
insure space is allocated for storing topology info for molecules that
are added later.</p>
</div>
<p>The format of an individual molecule file is similar but
(not identical) to the data file read by the <a class="reference internal" href="read_data.html"><span class="doc">read_data</span></a>
commands, and is as follows.</p>
<p>A molecule file has a header and a body.  The header appears first.
The first line of the header is always skipped; it typically contains
a description of the file.  Then lines are read one at a time.  Lines
can have a trailing comment starting with ‘#’ that is ignored.  If the
line is blank (only white-space after comment is deleted), it is
skipped.  If the line contains a header keyword, the corresponding
value(s) is read from the line.  If it does not contain a header
keyword, the line begins the body of the file.</p>
<p>The body of the file contains zero or more sections.  The first line
of a section has only a keyword.  The next line is skipped.  The
remaining lines of the section contain values.  The number of lines
depends on the section keyword as described below.  Zero or more blank
lines can be used between sections.  Sections can appear in any order,
with a few exceptions as noted below.</p>
<p>These are the recognized header keywords.  Header lines can come in
any order.  The numeric value(s) are read from the beginning of the
line.  The keyword should appear at the end of the line.  All these
settings have default values, as explained below.  A line need only
appear if the value(s) are different than the default.</p>
<ul class="simple">
<li><p>N <em>atoms</em> = # of atoms N in molecule, default = 0</p></li>
<li><p>Nb <em>bonds</em> = # of bonds Nb in molecule, default = 0</p></li>
<li><p>Na <em>angles</em> = # of angles Na in molecule, default = 0</p></li>
<li><p>Nd <em>dihedrals</em> = # of dihedrals Nd in molecule, default = 0</p></li>
<li><p>Ni <em>impropers</em> = # of impropers Ni in molecule, default = 0</p></li>
<li><p>Nf <em>fragments</em> = # of fragments in molecule, default = 0</p></li>
<li><p>Mtotal <em>mass</em> = total mass of molecule</p></li>
<li><p>Xc Yc Zc <em>com</em> = coordinates of center-of-mass of molecule</p></li>
<li><p>Ixx Iyy Izz Ixy Ixz Iyz <em>inertia</em> = 6 components of inertia tensor of molecule</p></li>
</ul>
<p>For <em>mass</em>, <em>com</em>, and <em>inertia</em>, the default is for LAMMPS to
calculate this quantity itself if needed, assuming the molecules
consists of a set of point particles or finite-size particles (with a
non-zero diameter) that do not overlap.  If finite-size particles in
the molecule do overlap, LAMMPS will not account for the overlap
effects when calculating any of these 3 quantities, so you should
pre-compute them yourself and list the values in the file.</p>
<p>The mass and center-of-mass coordinates (Xc,Yc,Zc) are
self-explanatory.  The 6 moments of inertia (ixx,iyy,izz,ixy,ixz,iyz)
should be the values consistent with the current orientation of the
rigid body around its center of mass.  The values are with respect to
the simulation box XYZ axes, not with respect to the principal axes of
the rigid body itself.  LAMMPS performs the latter calculation
internally.</p>
<p>These are the allowed section keywords for the body of the file.</p>
<ul class="simple">
<li><p><em>Coords, Types, Molecules, Fragments, Charges, Diameters, Masses</em> = atom-property sections</p></li>
<li><p><em>Bonds, Angles, Dihedrals, Impropers</em> = molecular topology sections</p></li>
<li><p><em>Special Bond Counts, Special Bonds</em> = special neighbor info</p></li>
<li><p><em>Shake Flags, Shake Atoms, Shake Bond Types</em> = SHAKE info</p></li>
</ul>
<p>If a Bonds section is specified then the Special Bond Counts and
Special Bonds sections can also be used, if desired, to explicitly
list the 1-2, 1-3, 1-4 neighbors within the molecule topology (see
details below).  This is optional since if these sections are not
included, LAMMPS will auto-generate this information.  Note that
LAMMPS uses this info to properly exclude or weight bonded pairwise
interactions between bonded atoms.  See the
<a class="reference internal" href="special_bonds.html"><span class="doc">special_bonds</span></a> command for more details.  One
reason to list the special bond info explicitly is for the
<a class="reference internal" href="Howto_drude.html"><span class="doc">thermalized Drude oscillator model</span></a> which treats the
bonds between nuclear cores and Drude electrons in a different manner.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Whether a section is required depends on how the molecule
template is used by other LAMMPS commands.  For example, to add a
molecule via the <a class="reference internal" href="fix_deposit.html"><span class="doc">fix deposit</span></a> command, the Coords
and Types sections are required.  To add a rigid body via the <a class="reference internal" href="fix_pour.html"><span class="doc">fix pour</span></a> command, the Bonds (Angles, etc) sections are not
required, since the molecule will be treated as a rigid body.  Some
sections are optional.  For example, the <a class="reference internal" href="fix_pour.html"><span class="doc">fix pour</span></a>
command can be used to add “molecules” which are clusters of
finite-size granular particles.  If the Diameters section is not
specified, each particle in the molecule will have a default diameter
of 1.0.  See the doc pages for LAMMPS commands that use molecule
templates for more details.</p>
</div>
<p>Each section is listed below in alphabetic order.  The format of each
section is described including the number of lines it must contain and
rules (if any) for whether it can appear in the data file.  For per-
atom sections, entries should be numbered from 1 to Natoms (where
Natoms is the number of atoms in the template), indicating which atom
(or bond, etc) the entry applies to.  Per-atom sections need to
include a setting for every atom, but the atoms can be listed in any
order.</p>
<hr class="docutils" />
<p><em>Coords</em> section:</p>
<ul class="simple">
<li><p>one line per atom</p></li>
<li><p>line syntax: ID x y z</p></li>
<li><p>x,y,z = coordinate of atom</p></li>
</ul>
<hr class="docutils" />
<p><em>Types</em> section:</p>
<ul class="simple">
<li><p>one line per atom</p></li>
<li><p>line syntax: ID type</p></li>
<li><p>type = atom type of atom</p></li>
</ul>
<hr class="docutils" />
<p><em>Molecules</em> section:</p>
<ul class="simple">
<li><p>one line per atom</p></li>
<li><p>line syntax: ID molecule-ID</p></li>
<li><p>molecule-ID = molecule ID of atom</p></li>
</ul>
<hr class="docutils" />
<p><em>Fragments</em> section:</p>
<ul class="simple">
<li><p>one line per fragment</p></li>
<li><p>line syntax: ID a b c d …</p></li>
<li><p>a,b,c,d,… = IDs of atoms in fragment</p></li>
</ul>
<p>The ID of a fragment can only contain alphanumeric characters and
underscores.  The atom IDs should be values from 1 to Natoms, where
Natoms = # of atoms in the molecule.</p>
<hr class="docutils" />
<p><em>Charges</em> section:</p>
<ul class="simple">
<li><p>one line per atom</p></li>
<li><p>line syntax: ID q</p></li>
<li><p>q = charge on atom</p></li>
</ul>
<p>This section is only allowed for <a class="reference internal" href="atom_style.html"><span class="doc">atom styles</span></a> that
support charge.  If this section is not included, the default charge
on each atom in the molecule is 0.0.</p>
<hr class="docutils" />
<p><em>Diameters</em> section:</p>
<ul class="simple">
<li><p>one line per atom</p></li>
<li><p>line syntax: ID diam</p></li>
<li><p>diam = diameter of atom</p></li>
</ul>
<p>This section is only allowed for <a class="reference internal" href="atom_style.html"><span class="doc">atom styles</span></a> that
support finite-size spherical particles, e.g. atom_style sphere.  If
not listed, the default diameter of each atom in the molecule is 1.0.</p>
<hr class="docutils" />
<p><em>Masses</em> section:</p>
<ul class="simple">
<li><p>one line per atom</p></li>
<li><p>line syntax: ID mass</p></li>
<li><p>mass = mass of atom</p></li>
</ul>
<p>This section is only allowed for <a class="reference internal" href="atom_style.html"><span class="doc">atom styles</span></a> that
support per-atom mass, as opposed to per-type mass.  See the
<a class="reference internal" href="mass.html"><span class="doc">mass</span></a> command for details.  If this section is not
included, the default mass for each atom is derived from its volume
(see Diameters section) and a default density of 1.0, in
<a class="reference internal" href="units.html"><span class="doc">units</span></a> of mass/volume.</p>
<hr class="docutils" />
<p><em>Bonds</em> section:</p>
<ul class="simple">
<li><p>one line per bond</p></li>
<li><p>line syntax: ID type atom1 atom2</p></li>
<li><p>type = bond type (1-Nbondtype)</p></li>
<li><p>atom1,atom2 = IDs of atoms in bond</p></li>
</ul>
<p>The IDs for the two atoms in each bond should be values
from 1 to Natoms, where Natoms = # of atoms in the molecule.</p>
<hr class="docutils" />
<p><em>Angles</em> section:</p>
<ul class="simple">
<li><p>one line per angle</p></li>
<li><p>line syntax: ID type atom1 atom2 atom3</p></li>
<li><p>type = angle type (1-Nangletype)</p></li>
<li><p>atom1,atom2,atom3 = IDs of atoms in angle</p></li>
</ul>
<p>The IDs for the three atoms in each angle should be values from 1 to
Natoms, where Natoms = # of atoms in the molecule.  The 3 atoms are
ordered linearly within the angle.  Thus the central atom (around
which the angle is computed) is the atom2 in the list.</p>
<hr class="docutils" />
<p><em>Dihedrals</em> section:</p>
<ul class="simple">
<li><p>one line per dihedral</p></li>
<li><p>line syntax: ID type atom1 atom2 atom3 atom4</p></li>
<li><p>type = dihedral type (1-Ndihedraltype)</p></li>
<li><p>atom1,atom2,atom3,atom4 = IDs of atoms in dihedral</p></li>
</ul>
<p>The IDs for the four atoms in each dihedral should be values from 1 to
Natoms, where Natoms = # of atoms in the molecule.  The 4 atoms are
ordered linearly within the dihedral.</p>
<hr class="docutils" />
<p><em>Impropers</em> section:</p>
<ul class="simple">
<li><p>one line per improper</p></li>
<li><p>line syntax: ID type atom1 atom2 atom3 atom4</p></li>
<li><p>type = improper type (1-Nimpropertype)</p></li>
<li><p>atom1,atom2,atom3,atom4 = IDs of atoms in improper</p></li>
</ul>
<p>The IDs for the four atoms in each improper should be values from 1 to
Natoms, where Natoms = # of atoms in the molecule.  The ordering of
the 4 atoms determines the definition of the improper angle used in
the formula for the defined <a class="reference internal" href="improper_style.html"><span class="doc">improper style</span></a>.  See
the doc pages for individual styles for details.</p>
<hr class="docutils" />
<p><em>Special Bond Counts</em> section:</p>
<ul class="simple">
<li><p>one line per atom</p></li>
<li><p>line syntax: ID N1 N2 N3</p></li>
<li><p>N1 = # of 1-2 bonds</p></li>
<li><p>N2 = # of 1-3 bonds</p></li>
<li><p>N3 = # of 1-4 bonds</p></li>
</ul>
<p>N1, N2, N3 are the number of 1-2, 1-3, 1-4 neighbors respectively of
this atom within the topology of the molecule.  See the
<a class="reference internal" href="special_bonds.html"><span class="doc">special_bonds</span></a> doc page for more discussion of
1-2, 1-3, 1-4 neighbors.  If this section appears, the Special Bonds
section must also appear.</p>
<p>As explained above, LAMMPS will auto-generate this information if this
section is not specified.  If specified, this section will
override what would be auto-generated.</p>
<hr class="docutils" />
<p><em>Special Bonds</em> section:</p>
<ul class="simple">
<li><p>one line per atom</p></li>
<li><p>line syntax: ID a b c d …</p></li>
<li><p>a,b,c,d,… = IDs of atoms in N1+N2+N3 special bonds</p></li>
</ul>
<p>A, b, c, d, etc are the IDs of the n1+n2+n3 atoms that are 1-2, 1-3,
1-4 neighbors of this atom.  The IDs should be values from 1 to
Natoms, where Natoms = # of atoms in the molecule.  The first N1
values should be the 1-2 neighbors, the next N2 should be the 1-3
neighbors, the last N3 should be the 1-4 neighbors.  No atom ID should
appear more than once.  See the <a class="reference internal" href="special_bonds.html"><span class="doc">special_bonds</span></a> doc
page for more discussion of 1-2, 1-3, 1-4 neighbors.  If this section
appears, the Special Bond Counts section must also appear.</p>
<p>As explained above, LAMMPS will auto-generate this information if this
section is not specified.  If specified, this section will override
what would be auto-generated.</p>
<hr class="docutils" />
<p><em>Shake Flags</em> section:</p>
<ul class="simple">
<li><p>one line per atom</p></li>
<li><p>line syntax: ID flag</p></li>
<li><p>flag = 0,1,2,3,4</p></li>
</ul>
<p>This section is only needed when molecules created using the template
will be constrained by SHAKE via the “fix shake” command.  The other
two Shake sections must also appear in the file, following this one.</p>
<p>The meaning of the flag for each atom is as follows.  See the <a class="reference internal" href="fix_shake.html"><span class="doc">fix shake</span></a> doc page for a further description of SHAKE
clusters.</p>
<ul class="simple">
<li><p>0 = not part of a SHAKE cluster</p></li>
<li><p>1 = part of a SHAKE angle cluster (two bonds and the angle they form)</p></li>
<li><p>2 = part of a 2-atom SHAKE cluster with a single bond</p></li>
<li><p>3 = part of a 3-atom SHAKE cluster with two bonds</p></li>
<li><p>4 = part of a 4-atom SHAKE cluster with three bonds</p></li>
</ul>
<hr class="docutils" />
<p><em>Shake Atoms</em> section:</p>
<ul class="simple">
<li><p>one line per atom</p></li>
<li><p>line syntax: ID a b c d</p></li>
<li><p>a,b,c,d = IDs of atoms in cluster</p></li>
</ul>
<p>This section is only needed when molecules created using the template
will be constrained by SHAKE via the “fix shake” command.  The other
two Shake sections must also appear in the file.</p>
<p>The a,b,c,d values are atom IDs (from 1 to Natoms) for all the atoms
in the SHAKE cluster that this atom belongs to.  The number of values
that must appear is determined by the shake flag for the atom (see the
Shake Flags section above).  All atoms in a particular cluster should
list their a,b,c,d values identically.</p>
<p>If flag = 0, no a,b,c,d values are listed on the line, just the
(ignored) ID.</p>
<p>If flag = 1, a,b,c are listed, where a = ID of central atom in the
angle, and b,c the other two atoms in the angle.</p>
<p>If flag = 2, a,b are listed, where a = ID of atom in bond with the
lowest ID, and b = ID of atom in bond with the highest ID.</p>
<p>If flag = 3, a,b,c are listed, where a = ID of central atom,
and b,c = IDs of other two atoms bonded to the central atom.</p>
<p>If flag = 4, a,b,c,d are listed, where a = ID of central atom,
and b,c,d = IDs of other three atoms bonded to the central atom.</p>
<p>See the <a class="reference internal" href="fix_shake.html"><span class="doc">fix shake</span></a> doc page for a further description
of SHAKE clusters.</p>
<hr class="docutils" />
<p><em>Shake Bond Types</em> section:</p>
<ul class="simple">
<li><p>one line per atom</p></li>
<li><p>line syntax: ID a b c</p></li>
<li><p>a,b,c = bond types (or angle type) of bonds (or angle) in cluster</p></li>
</ul>
<p>This section is only needed when molecules created using the template
will be constrained by SHAKE via the “fix shake” command.  The other
two Shake sections must also appear in the file.</p>
<p>The a,b,c values are bond types (from 1 to Nbondtypes) for all bonds
in the SHAKE cluster that this atom belongs to.  The number of values
that must appear is determined by the shake flag for the atom (see the
Shake Flags section above).  All atoms in a particular cluster should
list their a,b,c values identically.</p>
<p>If flag = 0, no a,b,c values are listed on the line, just the
(ignored) ID.</p>
<p>If flag = 1, a,b,c are listed, where a = bondtype of the bond between
the central atom and the first non-central atom (value b in the Shake
Atoms section), b = bondtype of the bond between the central atom and
the second non-central atom (value c in the Shake Atoms section), and c =
the angle type (1 to Nangletypes) of the angle between the 3 atoms.</p>
<p>If flag = 2, only a is listed, where a = bondtype of the bond between
the 2 atoms in the cluster.</p>
<p>If flag = 3, a,b are listed, where a = bondtype of the bond between
the central atom and the first non-central atom (value b in the Shake
Atoms section), and b = bondtype of the bond between the central atom
and the second non-central atom (value c in the Shake Atoms section).</p>
<p>If flag = 4, a,b,c are listed, where a = bondtype of the bond between
the central atom and the first non-central atom (value b in the Shake
Atoms section), b = bondtype of the bond between the central atom and
the second non-central atom (value c in the Shake Atoms section), and c =
bondtype of the bond between the central atom and the third non-central
atom (value d in the Shake Atoms section).</p>
<p>See the <a class="reference internal" href="fix_shake.html"><span class="doc">fix shake</span></a> doc page for a further description
of SHAKE clusters.</p>
</div>
<hr class="docutils" />
<div class="section" id="restrictions">
<h2>Restrictions<a class="headerlink" href="#restrictions" title="Permalink to this headline">¶</a></h2>
<p>None</p>
</div>
<div class="section" id="related-commands">
<h2>Related commands<a class="headerlink" href="#related-commands" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="fix_deposit.html"><span class="doc">fix deposit</span></a>, <a class="reference internal" href="fix_pour.html"><span class="doc">fix pour</span></a>,
<a class="reference internal" href="fix_gcmc.html"><span class="doc">fix gcmc</span></a></p>
</div>
<div class="section" id="default">
<h2>Default<a class="headerlink" href="#default" title="Permalink to this headline">¶</a></h2>
<p>The default keywords values are offset 0 0 0 0 0 and scale = 1.0.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="neb.html" class="btn btn-neutral float-right" title="neb command" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="minimize.html" class="btn btn-neutral float-left" title="minimize command" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2003-2020 Sandia Corporation

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>