LAMMPS (18 Feb 2013)
# 2d LJ obstacle flow

dimension	2
boundary	p s p

atom_style	atomic
neighbor	0.3 bin
neigh_modify	delay 5

# create geometry

lattice		hex 0.7
Lattice spacing in x,y,z = 1.28436 2.22457 1.28436
region		box block 0 40 0 10 -0.25 0.25
create_box	3 box
Created orthogonal box = (0 0 -0.321089) to (51.3743 22.2457 0.321089)
  4 by 1 by 1 MPI processor grid
create_atoms	1 box
Created 840 atoms

mass		1 1.0
mass		2 1.0
mass		3 1.0

# LJ potentials

pair_style	lj/cut 1.12246
pair_coeff	* * 1.0 1.0 1.12246

# define groups

region	        1 block INF INF INF 1.25 INF INF
group		lower region 1
120 atoms in group lower
region		2 block INF INF 8.75 INF INF INF
group		upper region 2
120 atoms in group upper
group		boundary union lower upper
240 atoms in group boundary
group		flow subtract all boundary
600 atoms in group flow

set		group lower type 2
  120 settings made for type
set		group upper type 3
  120 settings made for type

# initial velocities

compute	        mobile flow temp
velocity	flow create 1.0 482748 temp mobile
fix		1 all nve
fix		2 flow temp/rescale 200 1.0 1.0 0.02 1.0
fix_modify	2 temp mobile

# Poiselle flow

velocity	boundary set 0.0 0.0 0.0
fix		3 lower setforce 0.0 0.0 0.0
fix		4 upper setforce 0.0 NULL 0.0
fix		5 upper aveforce 0.0 -0.5 0.0
fix		6 flow addforce 1.0 0.0 0.0

# 2 obstacles

region		void1 sphere 10 4 0 3
delete_atoms	region void1
Deleted 36 atoms, new total = 804
region		void2 sphere 20 7 0 3
delete_atoms	region void2
Deleted 35 atoms, new total = 769

fix		7 flow indent 100 sphere 10 4 0 4
fix		8 flow indent 100 sphere 20 7 0 4
fix		9 all enforce2d

# Run

timestep	0.003
thermo		1000
thermo_modify	temp mobile
WARNING: Temperature for thermo pressure is not for group all (thermo.cpp:436)

#dump		1 all atom 100 dump.obstacle

#dump		1 all image 500 image.*.jpg type type #		zoom 1.6 adiam 1.5
#dump_modify	1 pad 5

run		25000
Memory usage per processor = 2.06043 Mbytes
Step Temp E_pair E_mol TotEng Press Volume 
       0    1.0004177            0            0   0.68689281   0.46210058    1143.0857 
    1000            1  -0.32494012            0   0.36166587    1.2240503    1282.5239 
    2000            1  -0.37815616            0   0.30844982    1.0642877    1312.5691 
    3000            1  -0.49062349            0    0.1959825    1.5239344    1322.2627 
    4000            1  -0.50104941            0   0.18555657    1.4605776    1367.6505 
    5000            1   -0.4655479            0   0.22105808    1.3317864    1406.9197 
    6000            1  -0.50936502            0   0.17724096    1.2130158    1424.3621 
    7000            1  -0.44959207            0   0.23701391    1.1070391       1443.1 
    8000            1  -0.42617261            0   0.26043338    1.2005043    1444.8955 
    9000            1  -0.41192389            0    0.2746821    1.0022569    1450.9691 
   10000            1  -0.40940409            0   0.27720189   0.98653582    1447.7805 
   11000            1   -0.4093125            0   0.27729348    1.0625786    1446.6852 
   12000            1  -0.41948268            0   0.26712331    1.1166793    1449.6135 
   13000            1  -0.38874722            0   0.29785877   0.99617473    1456.1633 
   14000            1  -0.40067763            0   0.28592835   0.98191459    1454.6009 
   15000            1  -0.39026612            0   0.29633987    1.0245506    1452.7783 
   16000            1  -0.39139643            0   0.29520955    1.0281029    1451.2662 
   17000            1  -0.37821271            0   0.30839327    1.0108601    1454.1047 
   18000            1  -0.37382372            0   0.31278227   0.93743647    1457.2083 
   19000            1   -0.3737367            0   0.31286928    1.0333603    1458.6131 
   20000            1  -0.37232139            0   0.31428459    1.0471568    1448.6511 
   21000            1  -0.40114891            0   0.28545707    1.0045402    1455.5644 
   22000            1  -0.36552339            0   0.32108259   0.99841802    1459.4723 
   23000            1  -0.35573934            0   0.33086665   0.89283563    1460.8941 
   24000            1   -0.3608262            0   0.32577978    1.0097641    1453.0004 
   25000            1  -0.36649381            0   0.32011217   0.98366691    1451.5444 
Loop time of 0.818261 on 4 procs for 25000 steps with 769 atoms

Pair  time (%) = 0.130597 (15.9603)
Neigh time (%) = 0.0388979 (4.75373)
Comm  time (%) = 0.20022 (24.469)
Outpt time (%) = 0.000515699 (0.0630239)
Other time (%) = 0.44803 (54.754)

Nlocal:    192.25 ave 242 max 159 min
Histogram: 2 0 0 0 0 1 0 0 0 1
Nghost:    43 ave 45 max 39 min
Histogram: 1 0 0 0 0 0 0 0 2 1
Neighs:    414 ave 588 max 284 min
Histogram: 2 0 0 0 0 0 1 0 0 1

Total # of neighbors = 1656
Ave neighs/atom = 2.15345
Neighbor list builds = 1641
Dangerous builds = 1
