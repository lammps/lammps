

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1.1.7. Neighbor list access &mdash; LAMMPS documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/tabs.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/lammps.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/lammps.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->

  
  <script src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="1.1.8. Configuration information" href="Library_config.html" />
    <link rel="prev" title="1.1.6. Scatter/gather operations" href="Library_scatter.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="Manual.html">
          

          
            
            <img src="_static/lammps-logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="lammps_version">Version: <b>24 Dec 2020</b></div>
              <div class="lammps_release">git info: patch 24Dec2020-115-g2b8a0d310</div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Intro.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">2. Install LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Build.html">3. Build LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Run_head.html">4. Run LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Commands.html">5. Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Packages.html">6. Optional packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="Speed.html">7. Accelerate performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="Howto.html">8. Howto discussions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Examples.html">9. Example scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tools.html">10. Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="Errors.html">11. Errors</a></li>
</ul>
<p class="caption"><span class="caption-text">Programmer Guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="Library.html">1. LAMMPS Library Interfaces</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="Library.html#lammps-c-library-api">1.1. LAMMPS C Library API</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Library_create.html">1.1.1. Creating or deleting a LAMMPS object</a></li>
<li class="toctree-l3"><a class="reference internal" href="Library_execute.html">1.1.2. Executing commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="Library_properties.html">1.1.3. System properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="Library_atoms.html">1.1.4. Per-atom properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="Library_objects.html">1.1.5. Compute, fixes, variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="Library_scatter.html">1.1.6. Scatter/gather operations</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">1.1.7. Neighbor list access</a></li>
<li class="toctree-l3"><a class="reference internal" href="Library_config.html">1.1.8. Configuration information</a></li>
<li class="toctree-l3"><a class="reference internal" href="Library_utility.html">1.1.9. Utility functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="Library_add.html">1.1.10. Extending the C API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Library.html#lammps-python-apis">1.2. LAMMPS Python APIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="Library.html#lammps-fortran-api">1.3. LAMMPS Fortran API</a></li>
<li class="toctree-l2"><a class="reference internal" href="Library.html#lammps-cplusplus-api">1.4. LAMMPS C++ API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Python_head.html">2. Use Python with LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Modify.html">3. Modifying &amp; extending LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="Developer.html">4. Information for Developers</a></li>
</ul>
<p class="caption"><span class="caption-text">Index</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="commands_list.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="fixes.html">Fixes</a></li>
<li class="toctree-l1"><a class="reference internal" href="computes.html">Computes</a></li>
<li class="toctree-l1"><a class="reference internal" href="pairs.html">Pair Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="bonds.html">Bond Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="angles.html">Angle Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="dihedrals.html">Dihedral Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="impropers.html">Improper Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="fix_modify_atc_commands.html">fix_modify AtC commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bibliography.html">Bibliography</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="Manual.html">LAMMPS</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="Manual.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="Library.html"><span class="section-number">1. </span>LAMMPS Library Interfaces</a> &raquo;</li>
        
      <li><span class="section-number">1.1.7. </span>Neighbor list access</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
          <a href="http://lammps.sandia.gov">Website</a>
          <a href="Commands_all.html">Commands</a>
        
      </li>
    
  </ul>

  
  <div class="rst-breadcrumbs-buttons" role="navigation" aria-label="breadcrumb navigation">
      
        <a href="Library_config.html" class="btn btn-neutral float-right" title="1.1.8. Configuration information" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Library_scatter.html" class="btn btn-neutral float-left" title="1.1.6. Scatter/gather operations" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
  </div>
  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="neighbor-list-access">
<h1><span class="section-number">1.1.7. </span>Neighbor list access<a class="headerlink" href="#neighbor-list-access" title="Permalink to this headline">¶</a></h1>
<p>The following functions enable access to neighbor lists generated by
LAMMPS or querying of their properties:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#_CPPv429lammps_find_compute_neighlistPvPci" title="lammps_find_compute_neighlist"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">lammps_find_compute_neighlist()</span></code></a></p></li>
<li><p><a class="reference internal" href="#_CPPv425lammps_find_fix_neighlistPvPci" title="lammps_find_fix_neighlist"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">lammps_find_fix_neighlist()</span></code></a></p></li>
<li><p><a class="reference internal" href="#_CPPv426lammps_find_pair_neighlistPvPciii" title="lammps_find_pair_neighlist"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">lammps_find_pair_neighlist()</span></code></a></p></li>
<li><p><a class="reference internal" href="#_CPPv429lammps_neighlist_num_elementsPvi" title="lammps_neighlist_num_elements"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">lammps_neighlist_num_elements()</span></code></a></p></li>
<li><p><a class="reference internal" href="#_CPPv434lammps_neighlist_element_neighborsPviiPiPiPPi" title="lammps_neighlist_element_neighbors"><code class="xref cpp cpp-func docutils literal notranslate"><span class="pre">lammps_neighlist_element_neighbors()</span></code></a></p></li>
</ul>
<hr class="docutils" />
<dl class="cpp function">
<dt id="_CPPv429lammps_find_compute_neighlistPvPci">
<span id="_CPPv329lammps_find_compute_neighlistPvPci"></span><span id="_CPPv229lammps_find_compute_neighlistPvPci"></span><span id="lammps_find_compute_neighlist__voidP.cP.i"></span><span class="target" id="library_8h_1a5edeb5237b7b9f16f45ee57fe6df053f"></span><span class="pre">int</span> <code class="sig-name descname"><span class="pre">lammps_find_compute_neighlist</span></code><span class="sig-paren">(</span><span class="pre">void</span> <span class="pre">*</span><em><span class="pre">handle</span></em>, <span class="pre">char</span> <span class="pre">*</span><em><span class="pre">id</span></em>, <span class="pre">int</span> <em><span class="pre">request</span></em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv429lammps_find_compute_neighlistPvPci" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Find neighbor list index of compute neighbor list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> – pointer to a previously created LAMMPS instance cast to <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span></code>. </p></li>
<li><p><strong>id</strong> – Identifier of fix instance </p></li>
<li><p><strong>request</strong> – request index that specifies which request should be returned, in case there are multiple neighbor lists for this fix </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>return neighbor list index if found, otherwise -1 </p>
</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="cpp function">
<dt id="_CPPv425lammps_find_fix_neighlistPvPci">
<span id="_CPPv325lammps_find_fix_neighlistPvPci"></span><span id="_CPPv225lammps_find_fix_neighlistPvPci"></span><span id="lammps_find_fix_neighlist__voidP.cP.i"></span><span class="target" id="library_8h_1a78fcc204bc13c071824dab034c31479a"></span><span class="pre">int</span> <code class="sig-name descname"><span class="pre">lammps_find_fix_neighlist</span></code><span class="sig-paren">(</span><span class="pre">void</span> <span class="pre">*</span><em><span class="pre">handle</span></em>, <span class="pre">char</span> <span class="pre">*</span><em><span class="pre">id</span></em>, <span class="pre">int</span> <em><span class="pre">request</span></em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv425lammps_find_fix_neighlistPvPci" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Find neighbor list index of fix neighbor list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> – pointer to a previously created LAMMPS instance cast to <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span></code>. </p></li>
<li><p><strong>id</strong> – Identifier of fix instance </p></li>
<li><p><strong>request</strong> – request index that specifies which request should be returned, in case there are multiple neighbor lists for this fix </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>return neighbor list index if found, otherwise -1 </p>
</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="cpp function">
<dt id="_CPPv426lammps_find_pair_neighlistPvPciii">
<span id="_CPPv326lammps_find_pair_neighlistPvPciii"></span><span id="_CPPv226lammps_find_pair_neighlistPvPciii"></span><span id="lammps_find_pair_neighlist__voidP.cP.i.i.i"></span><span class="target" id="library_8h_1a6e4e76b8dfd445c9479bc4247b9c82c3"></span><span class="pre">int</span> <code class="sig-name descname"><span class="pre">lammps_find_pair_neighlist</span></code><span class="sig-paren">(</span><span class="pre">void</span> <span class="pre">*</span><em><span class="pre">handle</span></em>, <span class="pre">char</span> <span class="pre">*</span><em><span class="pre">style</span></em>, <span class="pre">int</span> <em><span class="pre">exact</span></em>, <span class="pre">int</span> <em><span class="pre">nsub</span></em>, <span class="pre">int</span> <em><span class="pre">request</span></em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv426lammps_find_pair_neighlistPvPciii" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Find neighbor list index of pair style neighbor list</p>
<p>Try finding pair instance that matches style. If exact is set, the pair must match style exactly. If exact is 0, style must only be contained. If pair is of style pair/hybrid, style is instead matched the nsub-th hybrid sub-style.</p>
<p>Once the pair instance has been identified, multiple neighbor list requests may be found. Every neighbor list is uniquely identified by its request index. Thus, providing this request index ensures that the correct neighbor list index is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> – pointer to a previously created LAMMPS instance cast to <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span></code>. </p></li>
<li><p><strong>style</strong> – String used to search for pair style instance </p></li>
<li><p><strong>exact</strong> – Flag to control whether style should match exactly or only must be contained in pair style name </p></li>
<li><p><strong>nsub</strong> – match nsub-th hybrid sub-style </p></li>
<li><p><strong>request</strong> – request index that specifies which neighbor list should be returned, in case there are multiple neighbor lists requests for the found pair style </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>return neighbor list index if found, otherwise -1 </p>
</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="cpp function">
<dt id="_CPPv429lammps_neighlist_num_elementsPvi">
<span id="_CPPv329lammps_neighlist_num_elementsPvi"></span><span id="_CPPv229lammps_neighlist_num_elementsPvi"></span><span id="lammps_neighlist_num_elements__voidP.i"></span><span class="target" id="library_8h_1ab4cd0310c0638fad6352d0081194bdd8"></span><span class="pre">int</span> <code class="sig-name descname"><span class="pre">lammps_neighlist_num_elements</span></code><span class="sig-paren">(</span><span class="pre">void</span> <span class="pre">*</span><em><span class="pre">handle</span></em>, <span class="pre">int</span> <em><span class="pre">idx</span></em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv429lammps_neighlist_num_elementsPvi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return the number of entries in the neighbor list with given index</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> – pointer to a previously created LAMMPS instance cast to <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span></code>. </p></li>
<li><p><strong>idx</strong> – neighbor list index </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>return number of entries in neighbor list, -1 if idx is not a valid index </p>
</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="cpp function">
<dt id="_CPPv434lammps_neighlist_element_neighborsPviiPiPiPPi">
<span id="_CPPv334lammps_neighlist_element_neighborsPviiPiPiPPi"></span><span id="_CPPv234lammps_neighlist_element_neighborsPviiPiPiPPi"></span><span id="lammps_neighlist_element_neighbors__voidP.i.i.iP.iP.iPP"></span><span class="target" id="library_8h_1a0bd03926cf3a3ebb93311dab400c792c"></span><span class="pre">void</span> <code class="sig-name descname"><span class="pre">lammps_neighlist_element_neighbors</span></code><span class="sig-paren">(</span><span class="pre">void</span> <span class="pre">*</span><em><span class="pre">handle</span></em>, <span class="pre">int</span> <em><span class="pre">idx</span></em>, <span class="pre">int</span> <em><span class="pre">element</span></em>, <span class="pre">int</span> <span class="pre">*</span><em><span class="pre">iatom</span></em>, <span class="pre">int</span> <span class="pre">*</span><em><span class="pre">numneigh</span></em>, <span class="pre">int</span> <span class="pre">*</span><span class="pre">*</span><em><span class="pre">neighbors</span></em><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv434lammps_neighlist_element_neighborsPviiPiPiPPi" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Return atom local index, number of neighbors, and array of neighbor local atom indices of neighbor list entry</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handle</strong> – pointer to a previously created LAMMPS instance cast to <code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">*</span></code>. </p></li>
<li><p><strong>idx</strong> – index of this neighbor list in the list of all neighbor lists </p></li>
<li><p><strong>element</strong> – index of this neighbor list entry </p></li>
<li><p><strong>iatom</strong> – <strong>[out]</strong> local atom index (i.e. in the range [0, nlocal + nghost), -1 if invalid idx or element value </p></li>
<li><p><strong>numneigh</strong> – <strong>[out]</strong> number of neighbors of atom iatom or 0 </p></li>
<li><p><strong>neighbors</strong> – <strong>[out]</strong> pointer to array of neighbor atom local indices or NULL </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Library_config.html" class="btn btn-neutral float-right" title="1.1.8. Configuration information" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Library_scatter.html" class="btn btn-neutral float-left" title="1.1.6. Scatter/gather operations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2003-2020 Sandia Corporation

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>